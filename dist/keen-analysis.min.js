!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){function r(e,t){this.analysis=e,this.params={},this.set(t),void 0===this.params.timezone&&(this.params.timezone=-60*(new Date).getTimezoneOffset())}var o=e("keen-tracking"),i=e("./utils/promise"),a=e("keen-tracking/lib/utils/each"),s=e("keen-tracking/lib/utils/extend"),c=e("./request");o.resources.queries="{protocol}://{host}/3.0/projects/{projectId}/queries",s(o.prototype,c),o.prototype.masterKey=function(e){return arguments.length?(this.config.masterKey=e?String(e):null,this):this.config.masterKey},o.prototype.readKey=function(e){return arguments.length?(this.config.readKey=e?String(e):null,this):this.config.readKey},o.prototype.query=function(e,t){if(e&&t&&"string"==typeof t)return t.indexOf("/result")<0&&(t+="/result"),this.get(this.url("queries",e,t)).auth(this.readKey()).send();if(e&&t&&"object"==typeof t){var n=s({analysis_type:e},t);return this.post(this.url("queries",e)).auth(this.readKey()).send(n)}return e&&!t?i.reject({error_code:"SDKError",message:".query() called with incorrect arguments"}):void 0},o.Query=r,o.prototype.run=function(e,t){var n,r,c,u=this,l=t;return t=null,n=e instanceof Array?e:[e],r=[],a(n,function(e,t){"string"==typeof e?r.push(u.query("saved",e+"/result")):e instanceof o.Query&&r.push(u.query(e.analysis,s({analysis_type:e.analysis},e.params)))}),c=r.length>1?i.all(r):r[0],l&&(c.then(function(e){l(null,e)}),c["catch"](function(e){l(e,null)})),c},r.prototype.set=function(e){var t=this;return a(e,function(e,n){var r=n,o=e;n.match(new RegExp("[A-Z]"))&&(r=n.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})),t.params[r]=o,o instanceof Array&&a(o,function(e,n){e instanceof Array==0&&"object"==typeof e&&a(e,function(e,o){if(o.match(new RegExp("[A-Z]"))){var i=o.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()});delete t.params[r][n][o],t.params[r][n][i]=e}})})}),t},r.prototype.get=function(e){var t=e;return t.match(new RegExp("[A-Z]"))&&(t=t.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})),this.params?this.params[t]||null:void 0},r.prototype.addFilter=function(e,t,n){return this.params.filters=this.params.filters||[],this.params.filters.push({property_name:e,operator:t,property_value:n}),this},t.exports=o},{"./request":2,"./utils/promise":4,"keen-tracking":8,"keen-tracking/lib/utils/each":22,"keen-tracking/lib/utils/extend":23}],2:[function(e,t,n){function r(e){return function(t){return this.config={api_key:void 0,method:e,params:void 0,timeout:3e5,url:t},this}.bind(this)}function o(e){var t=e.split("/queries/");return t[t.length-1]}var i=e("./utils/promise"),a=(e("keen-tracking/lib/utils/each"),e("keen-tracking/lib/utils/extend")),s=(e("keen-tracking/lib/utils/json"),e("./utils/http-server"));t.exports={get:new r("GET"),post:new r("POST"),put:new r("PUT"),del:new r("DELETE")},r.prototype.auth=function(e){return this.config.api_key="string"==typeof e?e:void 0,this},r.prototype.timeout=function(e){return this.config.timeout="number"==typeof e?e:3e5,this},r.prototype.send=function(e){var t,n;return this.config.params=e&&"object"==typeof e?e:{},t=s[this.config.method],n=a({},this.config),"undefined"==typeof n.params.analysis_type&&n.url.indexOf("/queries/")>-1&&n.url.indexOf("/saved/")<0&&(n.params.analysis_type=o(n.url)),new i(function(e,r,o){var i=t(n,function(t,o){var i=o;t?r(t):("undefined"!=typeof n.params.event_collection&&"undefined"==typeof o.query&&(i=a({query:n.params},o)),e(i))});return o(function(){i.abort&&i.abort()}),i})}},{"./utils/http-server":3,"./utils/promise":4,"keen-tracking/lib/utils/each":22,"keen-tracking/lib/utils/extend":23,"keen-tracking/lib/utils/json":24}],3:[function(e,t,n){function r(e,t){return s()?c("GET",e,t):u()?l("GET",e,t):f(e,t)}function o(e,t){return s()?c("POST",e,t):u()?l("POST",e,t):void t("XHR POST not supported",null)}function i(e,t){return s()?c("PUT",e,t):void t("XHR PUT not supported",null)}function a(e,t){return s()?c("DELETE",e,t):void t("XHR DELETE not supported",null)}function s(){var e="undefined"==typeof window?this:window;if(e.XMLHttpRequest&&("file:"!=e.location.protocol||!e.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function c(e,t,n){var r=s(),o=n,i=t.url;return n=null,r.onreadystatechange=function(){var e;if(4==r.readyState)if(r.status>=200&&r.status<300)try{e=p.parse(r.responseText),o&&e&&o(null,e)}catch(t){o&&o(r,null)}else try{e=p.parse(r.responseText),o&&e&&o(e,null)}catch(t){o&&o(r,null)}},"GET"!==e?(r.open(e,i,!0),r.setRequestHeader("Authorization",t.api_key),r.setRequestHeader("Content-type","application/json"),t.params?r.send(p.stringify(t.params)):r.send()):(i+="?",t.api_key&&(i+="api_key="+t.api_key+"&"),t.params&&(i+=h(t.params)),r.open(e,i,!0),r.send()),r}function u(){var e="undefined"==typeof window?this:window;return e.XDomainRequest?new e.XDomainRequest:!1}function l(e,t,n){function r(e,t){i&&"function"==typeof i&&(i(e,t),n=i=void 0)}var o=u(),i=n;return o&&(o.timeout=t.timeout||3e5,o.ontimeout=function(){r(o,null)},o.onerror=function(){r(o,null)},o.onload=function(){var e=p.parse(o.responseText);r(null,e)},o.open(e.toLowerCase(),t.url),setTimeout(function(){t.params?o.send(h(t.params)):o.send()},0)),o}function f(e,t){function n(e,n){u=!0,o&&"function"==typeof o&&(o(e,n),t=o=void 0),window[c]=void 0;try{delete window[c]}catch(r){}s.removeChild(a)}var r=e.url,o=t,i=(new Date).getTime(),a=document.createElement("script"),s=document.getElementsByTagName("head")[0],c="keenJSONPCallback",u=!1;for(c+=i;c in window;)c+="a";window[c]=function(e){u!==!0&&n(null,e)},e.params&&(r+=h(e.params)),a.onreadystatechange=function(){u===!1&&"loaded"===this.readyState&&n("An error occurred",null)},a.onerror=function(){u===!1&&n("An error occurred",null)},a.src=r+"&jsonp="+c,s.appendChild(a)}var p=(e("keen-tracking/lib/utils/each"),e("keen-tracking/lib/utils/json")),h=e("./serialize");t.exports={GET:r,POST:o,PUT:i,DELETE:a}},{"./serialize":5,"keen-tracking/lib/utils/each":22,"keen-tracking/lib/utils/json":24}],4:[function(e,t,n){var r=e("bluebird/js/browser/bluebird.core");r.config({cancellation:!0,longStackTraces:!1,warnings:!1}),t.exports=r},{"bluebird/js/browser/bluebird.core":6}],5:[function(e,t,n){var r=e("keen-tracking/lib/utils/each"),o=e("keen-tracking/lib/utils/json");t.exports=function(e){var t=[];return r(e,function(e,n){"string"!=typeof e&&(e=o.stringify(e)),t.push(n+"="+encodeURIComponent(e))}),t.join("&")}},{"keen-tracking/lib/utils/each":22,"keen-tracking/lib/utils/json":24}],6:[function(e,t,n){(function(e,r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;"undefined"!=typeof window?o=window:"undefined"!=typeof r?o=r:"undefined"!=typeof self&&(o=self),o.Promise=e()}}(function(){var t,n,o;return function i(e,t,n){function r(a,s){if(!t[a]){if(!e[a]){var c="function"==typeof _dereq_&&_dereq_;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=t[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return r(n?n:t)},l,l.exports,i,e,t,n)}return t[a].exports}for(var o="function"==typeof _dereq_&&_dereq_,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,n,r){function o(){this._isTickUsed=!1,this._lateQueue=new f(16),this._normalQueue=new f(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=l}function i(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function a(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function s(e){this._normalQueue._pushOne(e),this._queueTick()}var c;try{throw new Error}catch(u){c=u}var l=t("./schedule"),f=t("./queue"),p=t("./util");o.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},o.prototype.disableTrampolineIfNecessary=function(){p.hasDevTools&&(this._trampolineEnabled=!1)},o.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},o.prototype.fatalError=function(t,n){n?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)),e.exit(2)):this.throwLater(t)},o.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},p.hasDevTools?(o.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?i.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},o.prototype.invoke=function(e,t,n){this._trampolineEnabled?a.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},o.prototype.settlePromises=function(e){this._trampolineEnabled?s.call(this,e):this._schedule(function(){e._settlePromises()})}):(o.prototype.invokeLater=i,o.prototype.invoke=a,o.prototype.settlePromises=s),o.prototype.invokeFirst=function(e,t,n){this._normalQueue.unshift(e,t,n),this._queueTick()},o.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),r=e.shift();t.call(n,r)}else t._settlePromises()}},o.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},o.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},o.prototype._reset=function(){this._isTickUsed=!1},n.exports=o,n.exports.firstLineError=c},{"./queue":17,"./schedule":18,"./util":21}],2:[function(e,t,n){t.exports=function(e,t,n,r){var o=!1,i=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},s=function(e,t){0===(50397184&this._bitField)&&this._resolveCallback(t.target)},c=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var u=n(i),l=new e(t);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(u),u instanceof e){var p={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:u};f._then(t,a,void 0,l,p),u._then(s,c,void 0,l,p),l._setOnCancel(u)}else l._resolveCallback(f);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},{}],3:[function(e,t,n){function r(){try{Promise===i&&(Promise=o)}catch(e){}return i}var o;"undefined"!=typeof Promise&&(o=Promise);var i=e("./promise")();i.noConflict=r,t.exports=i},{"./promise":15}],4:[function(e,t,n){t.exports=function(t,n,r,o){var i=e("./util"),a=i.tryCatch,s=i.errorObj,c=t._async;t.prototype["break"]=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e.isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n.isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this.isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=a(e).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this.isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":21}],5:[function(e,t,n){t.exports=function(t){function n(e,n,s){return function(c){var u=s._boundValue();e:for(var l=0;l<e.length;++l){var f=e[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(c instanceof f)return i(n).call(u,c)}else if("function"==typeof f){var p=i(f).call(u,c);if(p===a)return p;if(p)return i(n).call(u,c)}else if(r.isObject(c)){for(var h=o(f),d=0;d<h.length;++d){var v=h[d];if(f[v]!=c[v])continue e}return i(n).call(u,c)}}return t}}var r=e("./util"),o=e("./es5").keys,i=r.tryCatch,a=r.errorObj;return n}},{"./es5":10,"./util":21}],6:[function(e,t,n){t.exports=function(e){function t(){this._trace=new t.CapturedTrace(r())}function n(){return o?new t:void 0}function r(){var e=i.length-1;return e>=0?i[e]:void 0}var o=!1,i=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,i.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=i.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=n,t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var n=e.prototype._pushContext,i=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,c=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=i,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=c,o=!1},o=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=r,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},{}],7:[function(t,n,o){n.exports=function(n,o){function i(e,t,n){var r=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+H.toString(e));r._attachCancellationCallback(e)})}catch(o){return o}}function a(e){if(!this.isCancellable())return this;var t=this._onCancel();void 0!==t?H.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function s(){return this._onCancelField}function c(e){this._onCancelField=e}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function l(e,t){if(0!==(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function f(e,t){0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function p(){var e=this._boundTo;return void 0!==e&&e instanceof n?e.isFulfilled()?e.value():void 0:e}function h(){this._trace=new F(this._peekContext())}function d(e,t){if(U(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=C(e);H.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),H.notEnumerableProp(e,"__stackCleaned__",!0)}}}function v(e,t,n,r,o){if(void 0===e&&null!==t&&W){if(void 0!==o&&o._returnedNonUndefined())return;n&&(n+=" ");var i="a promise was created in a "+n+"handler but was not returned from it";r._warn(i,!0,t)}}function _(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),g(n)}function g(e,t,r){if(te.warnings){var o,i=new D(e);if(t)r._attachExtraTrace(i);else if(te.longStackTraces&&(o=n._peekContext()))o.attachExtraTrace(i);else{var a=C(i);i.stack=a.message+"\n"+a.stack.join("\n")}x(i,"",!0)}}function y(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function m(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function b(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],o=t.length-1,i=t[o],a=-1,s=r.length-1;s>=0;--s)if(r[s]===i){a=s;break}for(var s=a;s>=0;--s){var c=r[s];if(t[o]!==c)break;t.pop(),o--}t=r}}function w(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],o="    (No stack trace)"===r||M.test(r),i=o&&$(r);o&&!i&&(V&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function k(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||M.test(r))break}return n>0&&(t=t.slice(n)),t}function C(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?k(e):["    (No stack trace)"],{message:n,stack:w(t)}}function x(e,t,n){if("undefined"!=typeof console){var r;if(H.isObject(e)){var o=e.stack;r=t+B(o,e)}else r=t+String(e);"function"==typeof L?L(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function E(e,t,n,r){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(i){I.throwLater(i)}var a=!1;try{a=ee(e,n,r)}catch(i){a=!0,I.throwLater(i)}var s=!1;if(Z)try{s=Z(e.toLowerCase(),{reason:n,promise:r})}catch(i){s=!0,I.throwLater(i)}a||o||s||"unhandledRejection"!==e||x(n,"Unhandled rejection ")}function j(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():H.toString(e);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var r=JSON.stringify(e);t=r}catch(o){}0===t.length&&(t="(empty array)")}return"(<"+T(t)+">, no stack trace)"}function T(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function O(){return"function"==typeof Y}function S(e){var t=e.match(z);return t?{fileName:t[1],line:parseInt(t[2],10)}:void 0}function P(e,t){if(O()){for(var n,r,o=e.stack.split("\n"),i=t.stack.split("\n"),a=-1,s=-1,c=0;c<o.length;++c){var u=S(o[c]);if(u){n=u.fileName,a=u.line;break}}for(var c=0;c<i.length;++c){var u=S(i[c]);if(u){r=u.fileName,s=u.line;break}}0>a||0>s||!n||!r||n!==r||a>=s||($=function(e){if(q.test(e))return!0;var t=S(e);return t&&t.fileName===n&&a<=t.line&&t.line<=s?!0:!1})}}function F(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);Y(this,F),t>32&&this.uncycle()}var A,R,L,N=n._getDomain,I=n._async,D=t("./errors").Warning,H=t("./util"),U=H.canAttachTrace,q=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,M=null,B=null,V=!1,K=!(0==H.env("BLUEBIRD_DEBUG")),X=!(0==H.env("BLUEBIRD_WARNINGS")||!K&&!H.env("BLUEBIRD_WARNINGS")),Q=!(0==H.env("BLUEBIRD_LONG_STACK_TRACES")||!K&&!H.env("BLUEBIRD_LONG_STACK_TRACES")),W=0!=H.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(X||!!H.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),I.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){E("rejectionHandled",A,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),E("unhandledRejection",R,e,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(e,t,n){return g(e,t,n||this)},n.onPossiblyUnhandledRejection=function(e){var t=N();R="function"==typeof e?null===t?e:t.bind(e):void 0},n.onUnhandledRejectionHandled=function(e){var t=N();A="function"==typeof e?null===t?e:t.bind(e):void 0};var J=function(){};n.longStackTraces=function(){if(I.haveItemsQueued()&&!te.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!te.longStackTraces&&O()){var e=n.prototype._captureStackTrace,t=n.prototype._attachExtraTrace;te.longStackTraces=!0,J=function(){if(I.haveItemsQueued()&&!te.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=e,n.prototype._attachExtraTrace=t,o.deactivateLongStackTraces(),I.enableTrampoline(),te.longStackTraces=!1},n.prototype._captureStackTrace=h,n.prototype._attachExtraTrace=d,o.activateLongStackTraces(),I.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return te.longStackTraces&&O()},n.config=function(e){if(e=Object(e),"longStackTraces"in e&&(e.longStackTraces?n.longStackTraces():!e.longStackTraces&&n.hasLongStackTraces()&&J()),"warnings"in e){var t=e.warnings;te.warnings=!!t,W=te.warnings,H.isObject(t)&&"wForgottenReturn"in t&&(W=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!te.cancellation){if(I.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=u,n.prototype._propagateFrom=l,n.prototype._onCancel=s,n.prototype._setOnCancel=c,n.prototype._attachCancellationCallback=a,n.prototype._execute=i,G=l,te.cancellation=!0}},n.prototype._execute=function(e,t,n){try{e(t,n)}catch(r){return r}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(e){},n.prototype._attachCancellationCallback=function(e){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(e,t){};var G=f,$=function(){return!1},z=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;H.inherits(F,Error),o.CapturedTrace=F,F.prototype.uncycle=function(){var e=this._length;if(!(2>e)){for(var t=[],n={},r=0,o=this;void 0!==o;++r)t.push(o),o=o._parent;e=this._length=r;for(var r=e-1;r>=0;--r){var i=t[r].stack;void 0===n[i]&&(n[i]=r)}for(var r=0;e>r;++r){var a=t[r].stack,s=n[a];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var c=r>0?t[r-1]:this;e-1>s?(c._parent=t[s+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);for(var u=c._length+1,l=r-2;l>=0;--l)t[l]._length=u,u++;return}}}},F.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=C(e),n=t.message,r=[t.stack],o=this;void 0!==o;)r.push(w(o.stack.split("\n"))),o=o._parent;b(r),m(r),H.notEnumerableProp(e,"stack",y(n,r)),H.notEnumerableProp(e,"__stackCleaned__",!0)}};var Z,Y=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():j(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,M=e,B=t;var n=Error.captureStackTrace;return $=function(e){return q.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return M=/@/,B=t,V=!0,function(e){e.stack=(new Error).stack};var o;try{throw new Error}catch(i){o="stack"in i}return"stack"in r||!o||"number"!=typeof Error.stackTraceLimit?(B=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?j(t):t.toString()},null):(M=e,B=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}([]),ee=function(){if(H.isNode)return function(t,n,r){return"rejectionHandled"===t?e.emit(t,r):e.emit(t,n,r)};var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof r?r:void 0!==this?this:null;if(!t)return function(){return!1};try{var n=document.createEvent("CustomEvent");n.initCustomEvent("testingtheevent",!1,!0,{}),t.dispatchEvent(n),Z=function(e,n){var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),!t.dispatchEvent(r)}}catch(o){}var i={};return i.unhandledRejection="onunhandledRejection".toLowerCase(),i.rejectionHandled="onrejectionHandled".toLowerCase(),function(e,n,r){var o=i[e],a=t[o];return a?("rejectionHandled"===e?a.call(t,r):a.call(t,n,r),!0):!1}}();"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(L=function(e){console.warn(e)},H.isNode&&e.stderr.isTTY?L=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:H.isNode||"string"!=typeof(new Error).stack||(L=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var te={warnings:X,longStackTraces:!1,cancellation:!1};return Q&&n.longStackTraces(),{longStackTraces:function(){return te.longStackTraces},warnings:function(){return te.warnings},cancellation:function(){return te.cancellation},propagateFromFunction:function(){return G},boundValueFunction:function(){return p},checkForgottenReturns:v,setBounds:P,warn:g,deprecated:_,CapturedTrace:F}}},{"./errors":9,"./util":21}],8:[function(e,t,n){t.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype["return"]=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype["throw"]=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1],r=function(){throw t};return this.caught(e,r)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();var o=function(){return r};return this.caught(n,o)}}},{}],9:[function(e,t,n){function r(e,t){function n(r){return this instanceof n?(f(this,"message","string"==typeof r?r:t),f(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function o(e){return this instanceof o?(f(this,"name","OperationalError"),f(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(f(this,"message",e.message),f(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new o(e)}var i,a,s=e("./es5"),c=s.freeze,u=e("./util"),l=u.inherits,f=u.notEnumerableProp,p=r("Warning","warning"),h=r("CancellationError","cancellation error"),d=r("TimeoutError","timeout error"),v=r("AggregateError","aggregate error");try{i=TypeError,a=RangeError}catch(_){i=r("TypeError","type error"),a=r("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<g.length;++y)"function"==typeof Array.prototype[g[y]]&&(v.prototype[g[y]]=Array.prototype[g[y]]);s.defineProperty(v.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),v.prototype.isOperational=!0;var m=0;v.prototype.toString=function(){var e=Array(4*m+1).join(" "),t="\n"+e+"AggregateError of:\n";m++,e=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",o=r.split("\n"),i=0;i<o.length;++i)o[i]=e+o[i];r=o.join("\n"),t+=r+"\n"}return m--,t},l(o,Error);var b=Error.__BluebirdErrorTypes__;b||(b=c({CancellationError:h,TimeoutError:d,OperationalError:o,RejectionError:o,AggregateError:v}),f(Error,"__BluebirdErrorTypes__",b)),t.exports={Error:Error,TypeError:i,RangeError:a,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:p}},{"./es5":10,"./util":21}],10:[function(e,t,n){var r=function(){return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,i={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t},c=function(e,t){return{value:e[t]}},u=function(e,t,n){return e[t]=n.value,e},l=function(e){return e},f=function(e){try{return Object(e).constructor.prototype}catch(t){return a}},p=function(e){try{return"[object Array]"===i.call(e)}catch(t){return!1}};t.exports={isArray:p,keys:s,names:s,defineProperty:u,getDescriptor:c,freeze:l,getPrototypeOf:f,isES5:r,propertyIsWritable:function(){return!0}}}},{}],11:[function(e,t,n){t.exports=function(t,n){function r(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function o(e){this.finallyHandler=e}function i(e,t){return null!=e.cancelPromise?(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0):!1}function a(){return c.call(this,this.promise._target()._settledValue())}function s(e){return i(this,e)?void 0:(f.e=e,f)}function c(e){var r=this.promise,c=this.handler;if(!this.called){this.called=!0;var u=0===this.type?c.call(r._boundValue()):c.call(r._boundValue(),e);if(void 0!==u){r._setReturnedNonUndefined();var p=n(u,r);if(p instanceof t){if(null!=this.cancelPromise){if(p.isCancelled()){var h=new l("late cancellation observer");return r._attachExtraTrace(h),f.e=h,f}p.isPending()&&p._attachCancellationCallback(new o(this))}return p._then(a,s,void 0,this,void 0)}}}return r.isRejected()?(i(this),f.e=e,f):(i(this),e)}var u=e("./util"),l=t.CancellationError,f=u.errorObj;return o.prototype._resultCancelled=function(){i(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,o){return"function"!=typeof e?this.then():this._then(n,o,void 0,new r(this,t,e),void 0)},t.prototype.lastly=t.prototype["finally"]=function(e){return this._passThrough(e,0,c,c)},t.prototype.tap=function(e){return this._passThrough(e,1,c)},r}},{"./util":21}],12:[function(e,t,n){t.exports=function(t,n,r,o){
var i=e("./util");i.canEvaluate,i.tryCatch,i.errorObj;t.join=function(){var e,t=arguments.length-1;if(t>0&&"function"==typeof arguments[t]){e=arguments[t];var r}var o=[].slice.call(arguments);e&&o.pop();var r=new n(o).promise();return void 0!==e?r.spread(e):r}}},{"./util":21}],13:[function(e,t,n){t.exports=function(t,n,r,o,i){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var o=s(e).apply(this,arguments),a=r._popContext();return i.checkForgottenReturns(o,a,"Promise.method",r),r._resolveFromSyncValue(o),r}},t.attempt=t["try"]=function(e){if("function"!=typeof e)return o("expecting a function but got "+a.classString(e));var r=new t(n);r._captureStackTrace(),r._pushContext();var c;if(arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];c=a.isArray(u)?s(e).apply(l,u):s(e).call(l,u)}else c=s(e)();var f=r._popContext();return i.checkForgottenReturns(c,f,"Promise.try",r),r._resolveFromSyncValue(c),r},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":21}],14:[function(e,t,n){function r(e){return e instanceof Error&&l.getPrototypeOf(e)===Error.prototype}function o(e){var t;if(r(e)){t=new u(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var n=l.keys(e),o=0;o<n.length;++o){var i=n[o];f.test(i)||(t[i]=e[i])}return t}return a.markAsOriginatingFromRejection(e),e}function i(e,t){return function(n,r){if(null!==e){if(n){var i=o(s(n));e._attachExtraTrace(i),e._reject(i)}else if(t){var a=[].slice.call(arguments,1);e._fulfill(a)}else e._fulfill(r);e=null}}}var a=e("./util"),s=a.maybeWrapAsError,c=e("./errors"),u=c.OperationalError,l=e("./es5"),f=/^(?:name|message|stack|cause)$/;t.exports=i},{"./errors":9,"./es5":10,"./util":21}],15:[function(t,n,r){n.exports=function(){function n(){}function r(e,t){if("function"!=typeof t)throw new y("expecting a function but got "+h.classString(t));if(e.constructor!==o)throw new y("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}function o(e){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,e!==b&&(r(this,e),this._resolveFromExecutor(e)),this._promiseCreated()}function i(e){this.promise._resolveCallback(e)}function a(e){this.promise._rejectCallback(e,!1)}function s(e){var t=new o(b);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var c,u=function(){return new y("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},l=function(){return new o.PromiseInspection(this._target())},f=function(e){return o.reject(new y(e))},p={},h=t("./util");c=h.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},h.notEnumerableProp(o,"_getDomain",c);var d=t("./es5"),v=t("./async"),_=new v;d.defineProperty(o,"_async",{value:_});var g=t("./errors"),y=o.TypeError=g.TypeError;o.RangeError=g.RangeError;var m=o.CancellationError=g.CancellationError;o.TimeoutError=g.TimeoutError,o.OperationalError=g.OperationalError,o.RejectionError=g.OperationalError,o.AggregateError=g.AggregateError;var b=function(){},w={},k={},C=t("./thenables")(o,b),x=t("./promise_array")(o,b,C,f,n),E=t("./context")(o),j=(E.create,t("./debuggability")(o,E)),T=(j.CapturedTrace,t("./finally")(o,C)),O=t("./catch_filter")(k),S=t("./nodeback"),P=h.errorObj,F=h.tryCatch;return o.prototype.toString=function(){return"[object Promise]"},o.prototype.caught=o.prototype["catch"]=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),o=0;for(n=0;t-1>n;++n){var i=arguments[n];if(!h.isObject(i))return f("expecting an object but got "+h.classString(i));r[o++]=i}return r.length=o,e=arguments[n],this.then(void 0,O(r,e,this))}return this.then(void 0,e)},o.prototype.reflect=function(){return this._then(l,l,void 0,this,void 0)},o.prototype.then=function(e,t){if(j.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+h.classString(e);arguments.length>1&&(n+=", "+h.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},o.prototype.done=function(e,t){var n=this._then(e,t,void 0,void 0,void 0);n._setIsFinal()},o.prototype.spread=function(e){return"function"!=typeof e?f("expecting a function but got "+h.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},o.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},o.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new x(this).promise()},o.prototype.error=function(e){return this.caught(h.originatesFromRejection,e)},o.is=function(e){return e instanceof o},o.fromNode=o.fromCallback=function(e){var t=new o(b);t._captureStackTrace();var n=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,r=F(e)(S(t,n));return r===P&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},o.all=function(e){return new x(e).promise()},o.cast=function(e){var t=C(e);return t instanceof o||(t=new o(b),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},o.resolve=o.fulfilled=o.cast,o.reject=o.rejected=function(e){var t=new o(b);return t._captureStackTrace(),t._rejectCallback(e,!0),t},o.setScheduler=function(e){if("function"!=typeof e)throw new y("expecting a function but got "+h.classString(e));var t=_._schedule;return _._schedule=e,t},o.prototype._then=function(e,t,n,r,i){var a=void 0!==i,s=a?i:new o(b),u=this._target(),l=u._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&0!==(2097152&this._bitField)&&(r=0!==(50397184&l)?this._boundValue():u===this?void 0:this._boundTo));var f=c();if(0!==(50397184&l)){var p,h,d=u._settlePromiseCtx;0!==(33554432&l)?(h=u._rejectionHandler0,p=e):0!==(16777216&l)?(h=u._fulfillmentHandler0,p=t,u._unsetRejectionIsUnhandled()):(d=u._settlePromiseLateCancellationObserver,h=new m("late cancellation observer"),u._attachExtraTrace(h),p=t),_.invoke(d,u,{handler:null===f?p:"function"==typeof p&&f.bind(p),promise:s,receiver:r,value:h})}else u._addCallbacks(e,t,s,r,f);return s},o.prototype._length=function(){return 65535&this._bitField},o.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},o.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},o.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},o.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField},o.prototype._setRejected=function(){this._bitField=16777216|this._bitField},o.prototype._setFollowing=function(){this._bitField=67108864|this._bitField},o.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},o.prototype._isFinal=function(){return(4194304&this._bitField)>0},o.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},o.prototype._setCancelled=function(){this._bitField=65536|this._bitField},o.prototype._setAsyncGuaranteed=function(){this._bitField=134217728|this._bitField},o.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==p)return void 0===t&&this._isBound()?this._boundValue():t},o.prototype._promiseAt=function(e){return this[4*e-4+2]},o.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},o.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},o.prototype._boundValue=function(){},o.prototype._migrateCallback0=function(e){var t=(e._bitField,e._fulfillmentHandler0),n=e._rejectionHandler0,r=e._promise0,o=e._receiverAt(0);void 0===o&&(o=p),this._addCallbacks(t,n,r,o,null)},o.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=p),this._addCallbacks(n,r,o,i,null)},o.prototype._addCallbacks=function(e,t,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=null===o?e:o.bind(e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:o.bind(t));else{var a=4*i-4;this[a+2]=n,this[a+3]=r,"function"==typeof e&&(this[a+0]=null===o?e:o.bind(e)),"function"==typeof t&&(this[a+1]=null===o?t:o.bind(t))}return this._setLength(i+1),i},o.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},o.prototype._resolveCallback=function(e,t){if(0===(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var n=C(e,this);if(!(n instanceof o))return this._fulfill(e);t&&this._propagateFrom(n,2);var r=n._target(),i=r._bitField;if(0===(50397184&i)){var a=this._length();a>0&&r._migrateCallback0(this);for(var s=1;a>s;++s)r._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!==(33554432&i))this._fulfill(r._value());else if(0!==(16777216&i))this._reject(r._reason());else{var c=new m("late cancellation observer");r._attachExtraTrace(c),this._reject(c)}}},o.prototype._rejectCallback=function(e,t,n){var r=h.ensureErrorObject(e),o=r===e;if(!o&&!n&&j.warnings()){var i="a promise was rejected with a non-error: "+h.classString(e);this._warn(i,!0)}this._attachExtraTrace(r,t?o:!1),this._reject(e)},o.prototype._resolveFromExecutor=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)},o.prototype._settlePromiseFromHandler=function(e,t,n,r){var o=r._bitField;if(0===(65536&o)){r._pushContext();var i;t===w?n&&"number"==typeof n.length?i=F(e).apply(this._boundValue(),n):(i=P,i.e=new y("cannot .spread() a non-array: "+h.classString(n))):i=F(e).call(t,n);var a=r._popContext();if(o=r._bitField,0===(65536&o))if(i===k)r._reject(n);else if(i===P||i===r){var s=i===r?u():i.e;r._rejectCallback(s,!1)}else j.checkForgottenReturns(i,a,"",r,this),r._resolveCallback(i)}},o.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},o.prototype._followee=function(){return this._rejectionHandler0},o.prototype._setFollowee=function(e){this._rejectionHandler0=e},o.prototype._settlePromise=function(e,t,r,i){var a=e instanceof o,s=this._bitField,c=0!==(134217728&s);0!==(65536&s)?(a&&e._invokeInternalOnCancel(),r instanceof T?(r.cancelPromise=e,F(t).call(r,i)===P&&e._reject(P.e)):t===l?e._fulfill(l.call(r)):r instanceof n?r._promiseCancelled(e):a||e instanceof x?e._cancel():r.cancel()):"function"==typeof t?a?(c&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,i,e)):t.call(r,i,e):r instanceof n?r._isResolved()||(0!==(33554432&s)?r._promiseFulfilled(i,e):r._promiseRejected(i,e)):a&&(c&&e._setAsyncGuaranteed(),0!==(33554432&s)?e._fulfill(i):e._reject(i))},o.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,i=e.value;"function"==typeof t?n instanceof o?this._settlePromiseFromHandler(t,r,i,n):t.call(r,i,n):n instanceof o&&n._reject(i)},o.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},o.prototype._settlePromise0=function(e,t,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,o,t)},o.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},o.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!==(134217728&t)?this._settlePromises():_.settlePromises(this))}},o.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?_.fatalError(e,h.isNode):void((65535&t)>0?0!==(134217728&t)?this._settlePromises():_.settlePromises(this):this._ensurePossibleRejectionHandled())},o.prototype._fulfillPromises=function(e,t){for(var n=1;e>n;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},o.prototype._rejectPromises=function(e,t){for(var n=1;e>n;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},o.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!==(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},o.prototype._settledValue=function(){var e=this._bitField;return 0!==(33554432&e)?this._rejectionHandler0:0!==(16777216&e)?this._fulfillmentHandler0:void 0},o.defer=o.pending=function(){j.deprecated("Promise.defer","new Promise");var e=new o(b);return{promise:e,resolve:i,reject:a}},h.notEnumerableProp(o,"_makeSelfResolutionError",u),t("./method")(o,b,C,f,j),t("./bind")(o,b,C,j),t("./cancel")(o,x,f,j),t("./direct_resolve")(o),t("./synchronous_inspection")(o),t("./join")(o,x,C,b,j),o.Promise=o,h.toFastProperties(o),h.toFastProperties(o.prototype),s({a:1}),s({b:2}),s({c:3}),s(1),s(function(){}),s(void 0),s(!1),s(new o(b)),j.setBounds(v.firstLineError,h.lastLineError),o}},{"./async":1,"./bind":2,"./cancel":4,"./catch_filter":5,"./context":6,"./debuggability":7,"./direct_resolve":8,"./errors":9,"./es5":10,"./finally":11,"./join":12,"./method":13,"./nodeback":14,"./promise_array":16,"./synchronous_inspection":19,"./thenables":20,"./util":21}],16:[function(e,t,n){t.exports=function(t,n,r,o,i){function a(e){switch(e){case-2:return[];case-3:return{}}}function s(e){var r=this._promise=new t(n);e instanceof t&&r._propagateFrom(e,3),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var c=e("./util");c.isArray;return c.inherits(s,i),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function u(e,n){var i=r(this._values,this._promise);if(i instanceof t){i=i._target();var s=i._bitField;if(this._values=i,0===(50397184&s))return this._promise._setAsyncGuaranteed(),i._then(u,this._reject,void 0,this,n);if(0===(33554432&s))return 0!==(16777216&s)?this._reject(i._reason()):this._cancel();i=i._value()}if(i=c.asArray(i),null===i){var l=o("expecting an array or an iterable object but got "+c.classString(i)).reason();return void this._promise._rejectCallback(l,!1)}return 0===i.length?void(-5===n?this._resolveEmptyArray():this._resolve(a(n))):void this._iterate(i)},s.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,a=null,s=0;n>s;++s){var c=r(e[s],o);c instanceof t?(c=c._target(),a=c._bitField):a=null,i?null!==a&&c.suppressUnhandledRejections():null!==a?0===(50397184&a)?(c._proxy(this,s),this._values[s]=c):i=0!==(33554432&a)?this._promiseFulfilled(c._value(),s):0!==(16777216&a)?this._promiseRejected(c._reason(),s):this._promiseCancelled(s):i=this._promiseFulfilled(c,s)}i||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise.isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},{"./util":21}],17:[function(e,t,n){function r(e,t,n,r,o){for(var i=0;o>i;++i)n[i+r]=e[i+t],e[i+t]=void 0}function o(e){this._capacity=e,this._length=0,this._front=0}o.prototype._willBeOverCapacity=function(e){return this._capacity<e},o.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},o.prototype._unshiftOne=function(e){var t=this._capacity;this._checkCapacity(this.length()+1);var n=this._front,r=(n-1&t-1^t)-t;this[r]=e,this._front=r,this._length=this.length()+1},o.prototype.unshift=function(e,t,n){this._unshiftOne(n),this._unshiftOne(t),this._unshiftOne(e)},o.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=n,this._length=r},o.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},o.prototype.length=function(){return this._length},o.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},o.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,o=this._length,i=n+o&t-1;r(this,0,this,t,i)},t.exports=o},{}],18:[function(t,n,o){var i,a=t("./util"),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")};if(a.isNode&&"undefined"==typeof MutationObserver){var c=r.setImmediate,u=e.nextTick;i=a.isRecentNode?function(e){c.call(r,e)}:function(t){u.call(e,t)}}else i="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:s:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,r=document.createElement("div"),o=new MutationObserver(function(){e.classList.toggle("foo"),n=!1});o.observe(r,t);var i=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(e,t),i()}}();n.exports=i},{"./util":21}],19:[function(e,t,n){t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},i=t.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};t.prototype.isCancelled=e.prototype._isCancelled=function(){return 65536===(65536&this._bitField)},e.prototype.isCancelled=function(){return this._target()._isCancelled()},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],20:[function(e,t,n){t.exports=function(t,n){function r(e,r){if(l(e)){if(e instanceof t)return e;var o=i(e);if(o===u){r&&r._pushContext();var c=t.reject(o.e);return r&&r._popContext(),c}if("function"==typeof o){if(a(e)){var c=new t(n);return e._then(c._fulfill,c._reject,void 0,c,null),c}return s(e,o,r)}}return e}function o(e){return e.then}function i(e){try{return o(e)}catch(t){return u.e=t,u}}function a(e){return f.call(e,"_promise0")}function s(e,r,o){function i(e){s&&(s._resolveCallback(e),s=null)}function a(e){s&&(s._rejectCallback(e,f,!0),s=null)}var s=new t(n),l=s;o&&o._pushContext(),s._captureStackTrace(),o&&o._popContext();var f=!0,p=c.tryCatch(r).call(e,i,a);return f=!1,s&&p===u&&(s._rejectCallback(p.e,!0,!0),s=null),l}var c=e("./util"),u=c.errorObj,l=c.isObject,f={}.hasOwnProperty;return r}},{"./util":21}],21:[function(t,n,r){function o(){try{var e=T;return T=null,e.apply(this,arguments)}catch(t){return j.e=t,j}}function i(e){return T=e,o}function a(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function s(e){return"function"==typeof e||"object"==typeof e&&null!==e}function c(e){return a(e)?new Error(g(e)):e}function u(e,t){var n,r=e.length,o=new Array(r+1);for(n=0;r>n;++n)o[n]=e[n];return o[n]=t,o}function l(e,t,n){if(!x.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function f(e,t,n){if(a(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return x.defineProperty(e,t,r),e}function p(e){throw e}function h(e){try{if("function"==typeof e){var t=x.names(e.prototype),n=x.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=P.test(e+"")&&x.names(e).length>0;if(n||r||o)return!0}return!1}catch(i){return!1}}function d(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}function v(e){return F.test(e)}function _(e,t,n){for(var r=new Array(e),o=0;e>o;++o)r[o]=t+o+n;return r}function g(e){try{return e+""}catch(t){return"[no string representation]"}}function y(e){try{f(e,"isOperational",!0)}catch(t){}}function m(e){return null==e?!1:e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0}function b(e){return e instanceof Error&&x.propertyIsWritable(e,"stack")}function w(e){return{}.toString.call(e)}function k(e,t,n){for(var r=x.names(e),o=0;o<r.length;++o){var i=r[o];if(n(i))try{x.defineProperty(t,i,x.getDescriptor(e,i))}catch(a){}}}function C(t,n){return N?e.env[t]:n}var x=t("./es5"),E="undefined"==typeof navigator,j={e:{}},T,O=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var r={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},S=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(x.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],o=Object.create(null);null!=e&&!t(e);){var i;try{i=n(e)}catch(a){return r}for(var s=0;s<i.length;++s){var c=i[s];if(!o[c]){o[c]=!0;var u=Object.getOwnPropertyDescriptor(e,c);null!=u&&null==u.get&&null==u.set&&r.push(c)}}e=x.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var i in n)if(r.call(n,i))o.push(i);else{for(var a=0;a<e.length;++a)if(r.call(e[a],i))continue e;o.push(i)}return o}}(),P=/this\s*\.\s*\S+\s*=/,F=/^[a-z$_][a-z$_0-9]*$/i,A=function(){return"stack"in new Error?function(e){return b(e)?e:new Error(g(e))}:function(e){if(b(e))return e;try{throw new Error(g(e))}catch(t){return t}}}(),R=function(e){return x.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var L="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};R=function(e){return x.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?L(e):null}}var N="undefined"!=typeof e&&"[object process]"===w(e).toLowerCase(),I={isClass:h,isIdentifier:v,inheritedDataKeys:S,getDataPropertyOrDefault:l,thrower:p,isArray:x.isArray,asArray:R,notEnumerableProp:f,isPrimitive:a,isObject:s,canEvaluate:E,errorObj:j,tryCatch:i,inherits:O,withAppended:u,maybeWrapAsError:c,toFastProperties:d,filledRange:_,toString:g,canAttachTrace:b,ensureErrorObject:A,originatesFromRejection:m,markAsOriginatingFromRejection:y,classString:w,copyDescriptors:k,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:N,env:C};I.isRecentNode=I.isNode&&function(){var t=e.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),I.isNode&&I.toFastProperties(e);try{throw new Error}catch(D){I.lastLineError=D}n.exports=I},{"./es5":10}]},{},[3])(3)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:7}],7:[function(e,t,n){function r(){l=!1,s.length?u=s.concat(u):f=-1,u.length&&o()}function o(){if(!l){var e=setTimeout(r);l=!0;for(var t=u.length;t;){for(s=u,u=[];++f<t;)s&&s[f].run();f=-1,t=u.length}s=null,l=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function a(){}var s,c=t.exports={},u=[],l=!1,f=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new i(e,t)),1!==u.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=a,c.addListener=a,c.once=a,c.off=a,c.removeListener=a,c.removeAllListeners=a,c.emit=a,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],8:[function(e,t,n){(function(r){!function(e){"undefined"!=typeof define&&define.amd&&"function"==typeof define&&define("keen-tracking",[],function(){return e()}),"object"==typeof n&&"undefined"!=typeof t&&(t.exports=e());var o=null;"undefined"!=typeof window?o=window:"undefined"!=typeof r?o=r:"undefined"!=typeof self&&(o=self),o&&(o.Keen=e())}(function(){function n(e){return i.loaded||"undefined"==typeof document?void e():(null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),document.readyState="complete"},!1),document.readyState="loading"),void r(e))}function r(e){/in/.test(document.readyState)?setTimeout(function(){r(e)},9):e()}function o(e,t,n,r,o){this.emit("error","This method has been deprecated. Check out DOM listeners: https://github.com/keen/keen-tracking.js#listeners");var i,a,s=e,c=s.currentTarget?s.currentTarget:s.srcElement||s.target,u=r||500,l=!1,f="";return void 0!==c.getAttribute?f=c.getAttribute("target"):c.target&&(f=c.target),"_blank"!=f&&"blank"!=f||s.metaKey||(a=window.open("about:blank"),a.document.location=c.href),"A"===c.nodeName?i=function(){l||s.metaKey||"_blank"===f||"blank"===f||(l=!0,window.location=c.href)}:"FORM"===c.nodeName?i=function(){l||(l=!0,c.submit())}:this.trigger("error","#trackExternalLink method not attached to an <a> or <form> DOM element"),o&&(i=function(){l||(l=!0,o())}),this.recordEvent(t,n,i),setTimeout(i,u),s.metaKey?void 0:!1}var i=e("./"),a=e("./utils/each"),s=e("./utils/extend"),c=e("./utils/listener")(i),u="undefined"!=typeof window?window:this,l=u.Keen;return s(i.prototype,e("./record-events-browser")),s(i.prototype,e("./defer-events")),s(i.prototype,{extendEvent:e("./extend-events").extendEvent,extendEvents:e("./extend-events").extendEvents}),i.prototype.trackExternalLink=o,s(i.helpers,{getBrowserProfile:e("./helpers/getBrowserProfile"),getDatetimeIndex:e("./helpers/getDatetimeIndex"),getDomNodePath:e("./helpers/getDomNodePath"),getScreenProfile:e("./helpers/getScreenProfile"),getUniqueId:e("./helpers/getUniqueId"),getWindowProfile:e("./helpers/getWindowProfile")}),s(i.utils,{cookie:e("./utils/cookie"),deepExtend:e("./utils/deepExtend"),each:a,extend:s,listener:c,parseParams:e("./utils/parseParams"),timer:e("./utils/timer")}),i.listenTo=function(e){a(e,function(e,t){var n=t.split(" "),r=n[0],o=n.slice(1,n.length).join(" ");return c(o).on(r,e)})},i.noConflict=function(){return u.Keen=l,i},i.ready=function(e){i.loaded?e():i.once("ready",e)},n(function(){i.loaded=!0,i.emit("ready")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1}),t.exports=i,i})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":17,"./defer-events":9,"./extend-events":10,"./helpers/getBrowserProfile":11,"./helpers/getDatetimeIndex":12,"./helpers/getDomNodePath":13,"./helpers/getScreenProfile":14,"./helpers/getUniqueId":15,"./helpers/getWindowProfile":16,"./record-events-browser":18,"./utils/cookie":20,"./utils/deepExtend":21,"./utils/each":22,"./utils/extend":23,"./utils/listener":25,"./utils/parseParams":26,"./utils/timer":28}],9:[function(e,t,n){function r(e,t){return 2!==arguments.length||"string"!=typeof e?void c.call(this,"Incorrect arguments provided to #deferEvent method"):(this.queue.events[e]=this.queue.events[e]||[],this.queue.events[e].push(t),this.queue.capacity++,this.emit("deferEvent",e,t),this)}function o(e){var t=this;return 1!==arguments.length||"object"!=typeof e?void c.call(this,"Incorrect arguments provided to #deferEvents method"):(u(e,function(e,n){t.queue.events[n]=t.queue.events[n]||[],t.queue.events[n]=t.queue.events[n].concat(e),t.queue.capacity=t.queue.capacity+e.length}),t.emit("deferEvents",e),t)}function i(e){return arguments.length?(this.queue.config.capacity=e?Number(e):0,this):this.queue.config.capacity}function a(e){return arguments.length?(this.queue.config.interval=e?Number(e):0,this):this.queue.config.interval}function s(){var e,t=this;return t.queue.capacity>0&&(e=JSON.parse(JSON.stringify(t.queue)),t.queue=l(),t.queue.options=e.options,t.emit("recordDeferredEvents",e.events),t.recordEvents(e.events,function(n,r){n?t.recordEvents(e.events):e=void 0})),t}function c(e){var t="Event(s) not deferred: "+e;this.emit("error",t)}var u=(e("./index"),e("./utils/each")),l=e("./utils/queue");t.exports={deferEvent:r,deferEvents:o,queueCapacity:i,queueInterval:a,recordDeferredEvents:s}},{"./index":17,"./utils/each":22,"./utils/queue":27}],10:[function(e,t,n){function r(e,t){return 2!==arguments.length||"string"!=typeof e||"object"!=typeof t&&"function"!=typeof t?void i.call(this,"Incorrect arguments provided to #extendEvent method"):(this.extensions.collections[e]=this.extensions.collections[e]||[],this.extensions.collections[e].push(t),this.emit("extendEvent",e,t),this)}function o(e){return 1!==arguments.length||"object"!=typeof e&&"function"!=typeof e?void i.call(this,"Incorrect arguments provided to #extendEvents method"):(this.extensions.events.push(e),
this.emit("extendEvents",e),this)}function i(e){var t="Event(s) not extended: "+e;this.emit("error",t)}function a(e,t){return t&&t.length>0&&c(t,function(t,n){var r="function"==typeof t?t():t;s(e,r)}),e}var s=e("./utils/deepExtend"),c=e("./utils/each");t.exports={extendEvent:r,extendEvents:o,getExtendedEventBody:a}},{"./utils/deepExtend":21,"./utils/each":22}],11:[function(e,t,n){function r(){return{cookies:"undefined"!=typeof navigator.cookieEnabled?navigator.cookieEnabled:!1,codeName:navigator.appCodeName,language:navigator.language,name:navigator.appName,online:navigator.onLine,platform:navigator.platform,useragent:navigator.userAgent,version:navigator.appVersion,screen:o(),window:i()}}var o=e("./getScreenProfile"),i=e("./getWindowProfile");t.exports=r},{"./getScreenProfile":14,"./getWindowProfile":16}],12:[function(e,t,n){function r(e){var t=e||new Date;return{hour_of_day:t.getHours(),day_of_week:parseInt(1+t.getDay()),day_of_month:t.getDate(),month:parseInt(1+t.getMonth()),year:t.getFullYear()}}t.exports=r},{}],13:[function(e,t,n){function r(e){if(!e.nodeName)return"";for(var t=[];null!=e.parentNode;){for(var n=0,r=0,o=0;o<e.parentNode.childNodes.length;o++){var i=e.parentNode.childNodes[o];i.nodeName==e.nodeName&&(i===e&&(r=n),n++)}e.hasAttribute("id")&&""!=e.id?t.unshift(e.nodeName.toLowerCase()+"#"+e.id):n>1?t.unshift(e.nodeName.toLowerCase()+":eq("+r+")"):t.unshift(e.nodeName.toLowerCase()),e=e.parentNode}return t.slice(1).join(" > ")}t.exports=r},{}],14:[function(e,t,n){function r(){var e,t;if("undefined"==typeof window||!window.screen)return{};e=["height","width","colorDepth","pixelDepth","availHeight","availWidth"],t={};for(var n=0;n<e.length;n++)t[e[n]]=window.screen[e[n]]?window.screen[e[n]]:null;return t.orientation={angle:window.screen.orientation?window.screen.orientation.angle:0,type:window.innerWidth>window.innerHeight?"landscape":"portrait"},t}t.exports=r},{}],15:[function(e,t,n){function r(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";return e.replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}t.exports=r},{}],16:[function(e,t,n){function r(){var e,t,n;return"undefined"==typeof document?{}:(e=document.body,t=document.documentElement,n={height:"innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,width:"innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth,scrollHeight:Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)||null},window.screen&&(n.ratio={height:window.screen.availHeight?parseFloat((window.innerHeight/window.screen.availHeight).toFixed(2)):null,width:window.screen.availWidth?parseFloat((window.innerWidth/window.screen.availWidth).toFixed(2)):null}),n)}t.exports=r},{}],17:[function(e,t,n){var r=e("component-emitter"),o=(e("./utils/json"),e("./utils/each")),i=e("./utils/extend"),a=e("./utils/queue"),s=function(e){var t=this;this.configure(e),i(this.config.resources,s.resources),this.extensions={events:[],collections:{}},this.queue=a(),this.queue.on("flush",function(){t.recordDeferredEvents()}),s.debug&&this.on("error",s.log),this.emit("ready"),s.emit("client",this)};r(s),r(s.prototype),i(s,{debug:!1,enabled:!0,loaded:!1,helpers:{},resources:{base:"{protocol}://{host}",version:"{protocol}://{host}/3.0",projects:"{protocol}://{host}/3.0/projects",projectId:"{protocol}://{host}/3.0/projects/{projectId}",events:"{protocol}://{host}/3.0/projects/{projectId}/events"},utils:{},version:"__VERSION__"}),s.log=function(e){s.debug&&"object"==typeof console&&console.log("[Keen IO]",e)},s.prototype.configure=function(e){var t=this,n=e||{},r="https";return this.config=this.config||{projectId:void 0,writeKey:void 0,host:"api.keen.io",protocol:r,requestType:"jsonp",resources:{},writePath:void 0},"undefined"!=typeof document&&document.all&&(n.protocol="https:"!==document.location.protocol?"http":r),n.host&&n.host.replace(/.*?:\/\//g,""),i(this.config,n),t},s.prototype.projectId=function(e){return arguments.length?(this.config.projectId=e?String(e):null,this):this.config.projectId},s.prototype.writeKey=function(e){return arguments.length?(this.config.writeKey=e?String(e):null,this):this.config.writeKey},s.prototype.resources=function(e){if(!arguments.length)return this.config.resources;var t=this;return"object"==typeof e&&o(e,function(e,n){t.config.resources[n]=e?e:null}),this},s.prototype.url=function(e){var t,n=Array.prototype.slice.call(arguments,1),r=s.resources.base||"{protocol}://{host}";return t=e&&"string"==typeof e?this.config.resources[e]?this.config.resources[e]:r+e:r,o(this.config,function(e,n){"object"!=typeof e&&(t=t.replace("{"+n+"}",e))}),o(n,function(e,n){"string"==typeof e?t+="/"+e:"object"==typeof e&&(t+="?",o(e,function(e,n){t+=n+"="+e+"&"}),t=t.slice(0,-1))}),t},s.prototype.setGlobalProperties=function(e){return s.log("This method has been deprecated. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events"),e&&"function"==typeof e?(this.config.globalProperties=e,this):void this.emit("error","Invalid value for global properties: "+e)},s.prototype.writePath=function(e){return s.log("This method has been deprecated. Use client.url('events') instead."),arguments.length?this.projectId()?(this.config.writePath=e?String(e):"/3.0/projects/"+this.projectId()+"/events",this):(this.emit("error","Client instance is missing a projectId property"),this.config.writePath||"/3.0/projects/"+this.projectId()+"/events"):this.config.writePath},t.exports=s},{"./utils/each":22,"./utils/extend":23,"./utils/json":24,"./utils/queue":27,"component-emitter":29}],18:[function(e,t,n){function r(e,t,n,r){var o,i,a,h,y,k,C;if(o=this.url("events",encodeURIComponent(e)),i={},a=n,C="boolean"==typeof r?r:!0,s.call(this,a)){if(!e||"string"!=typeof e)return void c.call(this,"Collection name must be a string.",a);if(this.config.globalProperties&&(i=this.config.globalProperties(e)),m(i,t),k={},b.getExtendedEventBody(k,this.extensions.events),b.getExtendedEventBody(k,this.extensions.collections[e]),b.getExtendedEventBody(k,[i]),this.emit("recordEvent",e,k),!_.enabled)return c.call(this,"Keen.enabled is set to false.",a),!1;if(h=this.url("events",encodeURIComponent(e),{api_key:this.writeKey(),data:g.encode(w.stringify(k)),modified:(new Date).getTime()}),y=h.length<u(),C)switch(this.config.requestType){case"xhr":f.call(this,"POST",o,k,a);break;case"beacon":y?v.call(this,h,a):l.call(this,o,k,"Beacon URL length exceeds current browser limit, and XHR is not supported.",a);break;default:y?d.call(this,h,a):l.call(this,o,k,"JSONp URL length exceeds current browser limit, and XHR is not supported.",a)}else y&&p(h);return n=a=null,this}}function o(e,t){var n,r,o,i=this;return n=this.url("events"),r=t,t=null,s.call(this,r)?"object"!=typeof e||e instanceof Array?void c.call(this,"First argument must be an object",r):arguments.length>2?void c.call(this,"Incorrect arguments provided to #recordEvents method",r):(this.config.globalProperties&&y(e,function(t,n){y(t,function(t,r){var o=i.config.globalProperties(n);e[n][r]=m(o,t)})}),o={},y(e,function(e,t){o[t]=o[t]||[],y(e,function(e,n){var r={};b.getExtendedEventBody(r,i.extensions.events),b.getExtendedEventBody(r,i.extensions.collections[t]),b.getExtendedEventBody(r,[e]),o[t].push(r)})}),this.emit("recordEvents",o),_.enabled?(h()&&f.call(this,"POST",n,o,r),t=r=null,this):(c.call(this,"Keen.enabled is set to false.",r),!1)):void 0}function i(){this.emit("error","This method has been deprecated. Check out #recordEvent: https://github.com/keen/keen-tracking.js#record-a-single-event"),r.apply(this,arguments)}function a(){this.emit("error","This method has been deprecated. Check out #recordEvents: https://github.com/keen/keen-tracking.js#record-multiple-events"),o.apply(this,arguments)}function s(e){var t=e;return e=null,this.projectId()?this.writeKey()?!0:(c.call(this,"Keen.Client is missing a writeKey property.",t),!1):(c.call(this,"Keen.Client is missing a projectId property.",t),!1)}function c(e,t){var n="Event(s) not recorded: "+e;this.emit("error",n),t&&(t.call(this,n,null),t=null)}function u(){return"undefined"!=typeof window&&(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)?2e3:16e3}function l(e,t,n,r){h()?f.call(this,"POST",e,t,r):c.call(this,n)}function f(e,t,n,r){var o,i=this,a=h(),s=r;r=null,a.onreadystatechange=function(){var e;if(4==a.readyState)if(a.status>=200&&a.status<300){try{e=w.parse(a.responseText)}catch(t){_.emit("error","Could not parse HTTP response: "+a.responseText),s&&s.call(i,a,null)}s&&e&&s.call(i,null,e)}else _.emit("error","HTTP request failed."),s&&s.call(i,a,null)},a.open(e,t,!0),a.setRequestHeader("Authorization",i.writeKey()),a.setRequestHeader("Content-Type","application/json"),n&&(o=w.stringify(n)),"GET"===e.toUpperCase()&&a.send(),"POST"===e.toUpperCase()&&a.send(o)}function p(e){var t=h();t&&(t.open("GET",e,!1),t.send(null))}function h(){var e="undefined"==typeof window?this:window;if(e.XMLHttpRequest&&("file:"!=e.location.protocol||!e.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function d(e,t){function n(){i&&i.call(o,"An error occurred!",null)}function r(){window[u]=void 0;try{delete window[u]}catch(e){}c.removeChild(s)}var o=this,i=t,a=(new Date).getTime(),s=document.createElement("script"),c=document.getElementsByTagName("head")[0],u="keenJSONPCallback",l=!1;for(t=null,u+=a;u in window;)u+="a";window[u]=function(e){l!==!0&&(l=!0,i&&i.call(o,null,e),r())},s.src=e+"&jsonp="+u,c.appendChild(s),s.onreadystatechange=function(){l===!1&&"loaded"===this.readyState&&(l=!0,n(),r())},s.onerror=function(){l===!1&&(l=!0,n(),r())}}function v(e,t){var n=this,r=t,o=document.createElement("img"),i=!1;t=null,o.onload=function(){if(i=!0,"naturalHeight"in this){if(this.naturalHeight+this.naturalWidth===0)return void this.onerror()}else if(this.width+this.height===0)return void this.onerror();r&&r.call(n)},o.onerror=function(){i=!0,r&&r.call(n,"An error occurred!",null)},o.src=e+"&c=clv1"}var _=e("./index"),g=e("./utils/base64"),y=e("./utils/each"),m=e("./utils/extend"),b=e("./extend-events"),w=e("./utils/json");t.exports={recordEvent:r,recordEvents:o,addEvent:i,addEvents:a}},{"./extend-events":10,"./index":17,"./utils/base64":19,"./utils/each":22,"./utils/extend":23,"./utils/json":24}],19:[function(e,t,n){t.exports={map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,o,i,a,s,c="",u=0,l=this.map;for(e=this.utf8.encode(e);u<e.length;)t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),o=t>>2,i=(3&t)<<4|n>>4,a=isNaN(n)?64:(15&n)<<2|r>>6,s=isNaN(n)||isNaN(r)?64:63&r,c=c+l.charAt(o)+l.charAt(i)+l.charAt(a)+l.charAt(s);return c},decode:function(e){var t,n,r,o,i,a,s,c="",u=0,l=this.map,f=String.fromCharCode;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)t=l.indexOf(e.charAt(u++)),n=l.indexOf(e.charAt(u++)),r=l.indexOf(e.charAt(u++)),o=l.indexOf(e.charAt(u++)),i=t<<2|n>>4,a=(15&n)<<4|r>>2,s=(3&r)<<6|o,c=c+(f(i)+(64!=r?f(a):""))+(64!=o?f(s):"");return this.utf8.decode(c)},utf8:{encode:function(e){for(var t,n="",r=0,o=String.fromCharCode;r<e.length;)t=e.charCodeAt(r++),n+=128>t?o(t):t>127&&2048>t?o(t>>6|192)+o(63&t|128):o(t>>12|224)+o(t>>6&63|128)+o(63&t|128);return n},decode:function(e){for(var t,n,r="",o=0,i=String.fromCharCode;o<e.length;)n=e.charCodeAt(o),r+=128>n?[i(n),o++][0]:n>191&&224>n?[i((31&n)<<6|63&(t=e.charCodeAt(o+1))),o+=2][0]:[i((15&n)<<12|(63&(t=e.charCodeAt(o+1)))<<6|63&(c3=e.charCodeAt(o+2))),o+=3][0];return r}}}},{}],20:[function(e,t,n){function r(e){return arguments.length?this instanceof r==!1?new r(e):(this.config={key:e,options:{}},this.data=this.get(),this):void 0}var o=e("cookies-js"),i=e("./json"),a=e("./extend");t.exports=r,r.prototype.get=function(e){var t={};return o.get(this.config.key)&&(t=i.parse(decodeURIComponent(o.get(this.config.key)))),e?"undefined"!=typeof t[e]?t[e]:null:t},r.prototype.set=function(e,t){return arguments.length&&this.enabled()?("string"==typeof e&&2===arguments.length?this.data[e]=t?t:null:"object"==typeof e&&1===arguments.length&&a(this.data,e),o.set(this.config.key,encodeURIComponent(i.stringify(this.data)),this.config.options),this):this},r.prototype.expire=function(){return o.expire(this.config.key),this.data={},this},r.prototype.options=function(e){return arguments.length?(this.config.options="object"==typeof e?e:{},this):this.config.options},r.prototype.enabled=function(){return o.enabled}},{"./extend":23,"./json":24,"cookies-js":30}],21:[function(e,t,n){function r(e){for(var t=1;t<arguments.length;t++)if(e instanceof Array&&arguments[t]instanceof Array)for(var n=0;n<arguments[t].length;n++)e.indexOf(arguments[t][n])<0&&e.push(arguments[t][n]);else for(var i in arguments[t])"undefined"!=typeof e[i]&&"object"==typeof arguments[t][i]&&null!==arguments[t][i]?r(e[i],o(arguments[t][i])):e[i]=o(arguments[t][i]);return e}function o(e){return i.parse(i.stringify(e))}var i=e("./json");t.exports=r},{"./json":24}],22:[function(e,t,n){function r(e,t,n){var r;if(!e)return 0;if(n=n?n:e,e instanceof Array){for(r=0;r<e.length;r++)if(t.call(n,e[r],r,e)===!1)return 0}else for(r in e)if(e.hasOwnProperty(r)&&t.call(n,e[r],r,e)===!1)return 0;return 1}t.exports=r},{}],23:[function(e,t,n){t.exports=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e}},{}],24:[function(e,t,n){t.exports="undefined"!=typeof window&&window.JSON?window.JSON:e("json3")},{json3:31}],25:[function(e,t,n){function r(e,t){document.addEventListener?document.addEventListener(e,t,!1):document.attachEvent("on"+e,t)}function o(e,t){for(var n=(e.parentNode||document).querySelectorAll(t)||[],r=n.length;r--;)if(n[r]==e)return!0;return!1}function i(e,t,n){var r,o,i=500;return void 0!==t.getAttribute?r=t.getAttribute("target"):t.target&&(r=t.target),o=n(e),"boolean"==typeof o&&o===!1||e.defaultPrevented||e.returnValue===!1?(e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1):("_blank"===r||"blank"===r||e.metaKey||(e.preventDefault&&e.preventDefault(),e.returnValue=!1,setTimeout(function(){window.location=t.href},i)),!1)}function a(e,t,n){var r=500;return cbResponse=n(e),"boolean"==typeof cbResponse&&cbResponse===!1||e.defaultPrevented||e.returnValue===!1?(e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1):(e.preventDefault&&e.preventDefault(),e.returnValue=!1,setTimeout(function(){t.submit()},r),!1)}var s=(e("component-emitter"),e("./each"));t.exports=function(e){function t(e){return e?this instanceof t==!1?new t(e):(this.selector=e,this):void 0}function n(t){return function(n){var r,c;r=n||window.event,c=r.target||r.srcElement,"undefined"!==e.domListeners[t]&&s(e.domListeners[t],function(e,n){o(c,n)?s(e,function(e,n){"click"===t&&"A"===c.nodeName?i(r,c,e):"submit"===t&&"FORM"===c.nodeName?a(r,c,e):e(r)}):"window"===n&&s(e,function(e,t){e(r)})})}}return e.domListeners=e.domListeners||{},t.prototype.on=function(t,o){var i=this;return 2!==arguments.length||"string"!=typeof t||"function"!=typeof o?this:("undefined"==typeof e.domListeners[t]&&(r(t,n(t)),e.domListeners[t]={}),e.domListeners[t][i.selector]=e.domListeners[t][i.selector]||[],e.domListeners[t][i.selector].push(o),i)},t.prototype.once=function(e,t){function n(){return r.off(e,n),t.apply(r,arguments)}var r=this;return n.fn=t,r.on(e,n),r},t.prototype.off=function(t,n){var r=this,o=[];if(2===arguments.length)s(e.domListeners[t][r.selector],function(e,t){e!==n&&e.fn!==n&&o.push(e)}),e.domListeners[t][r.selector]=o;else if(1===arguments.length)try{delete e.domListeners[t][r.selector]}catch(i){e.domListeners[t][r.selector]=[]}else s(e.domListeners,function(t,n){try{delete e.domListeners[n][r.selector]}catch(o){e.domListeners[n][r.selector]=function(){}}});return r},t}},{"./each":22,"component-emitter":29}],26:[function(e,t,n){function r(e){for(var t,n={},r=/\+/g,o=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(r," "))},a=e.split("?")[1];t=o.exec(a);)n[i(t[1])]=i(t[2]);return n}t.exports=r},{}],27:[function(e,t,n){function r(){var e=this;return this instanceof r==!1?new r:(e.capacity=0,e.interval=0,e.config={capacity:5e3,interval:15},e.events={},setInterval(function(){e.interval++,o.call(e)},1e3),e)}function o(){(this.capacity>0&&this.interval>=this.config.interval||this.capacity>=this.config.capacity)&&(this.emit("flush"),this.interval=0)}var i=e("component-emitter");t.exports=r,i(r.prototype)},{"component-emitter":29}],28:[function(e,t,n){function r(e){return this instanceof r==!1?new r(e):(this.count=e||0,this)}t.exports=r,r.prototype.start=function(){var e=this;return this.pause(),this.interval=setInterval(function(){e.count++},1e3),this},r.prototype.pause=function(){return clearInterval(this.interval),this},r.prototype.value=function(){return this.count},r.prototype.clear=function(){return this.count=0,this}},{}],29:[function(e,t,n){function r(e){return e?o(e):void 0}function o(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],30:[function(e,t,n){!function(e,r){var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){t._cachedDocumentCookie!==t._document.cookie&&t._renewCache();var n=t._cache[t._cacheKeyPrefix+e];return n===r?r:decodeURIComponent(n)},t.set=function(e,n,o){return o=t._getExtendedOptions(o),o.expires=t._getExpiresDate(n===r?-1:o.expires),t._document.cookie=t._generateCookieString(e,n,o),t},t.expire=function(e,n){return t.set(e,r,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var r=e+"="+t;return r+=n.path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",r+=n.expires?";expires="+n.expires.toUTCString():"",r+=n.secure?";secure":""},t._getCacheFromString=function(e){for(var n={},o=e?e.split("; "):[],i=0;i<o.length;i++){var a=t._getKeyValuePairFromCookieString(o[i]);n[t._cacheKeyPrefix+a.key]===r&&(n[t._cacheKeyPrefix+a.key]=a.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=0>t?e.length:t;var n,r=e.substr(0,t);try{n=decodeURIComponent(r)}catch(o){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+r+'"',o)}return{key:n,value:e.substr(t+1)}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},i="object"==typeof e.document?o(e):o;"function"==typeof define&&define.amd?define(function(){return i}):"object"==typeof n?("object"==typeof t&&"object"==typeof t.exports&&(n=t.exports=i),n.Cookies=i):e.Cookies=i}("undefined"==typeof window?this:window)},{}],31:[function(e,t,n){(function(e){(function(){function r(e,t){function n(e){if(n[e]!==_)return n[e];var r;if("bug-string-char-index"==e)r="a"!="a"[0];else if("json"==e)r=n("json-stringify")&&n("json-parse");else{var i,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var c=t.stringify,l="function"==typeof c&&m;if(l){(i=function(){return 1}).toJSON=i;try{l="0"===c(0)&&"0"===c(new o)&&'""'==c(new a)&&c(y)===_&&c(_)===_&&c()===_&&"1"===c(i)&&"[1]"==c([i])&&"[null]"==c([_])&&"null"==c(null)&&"[null,null,null]"==c([_,y,null])&&c({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==s&&"1"===c(null,i)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new u(-1))}catch(f){l=!1}}r=l}if("json-parse"==e){var p=t.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){i=p(s);var h=5==i.a.length&&1===i.a[0];if(h){try{h=!p('"	"')}catch(f){}if(h)try{h=1!==p("01")}catch(f){}if(h)try{h=1!==p("1.")}catch(f){}}}}catch(f){h=!1}r=h}}return n[e]=!!r}e||(e=s.Object()),t||(t=s.Object());var o=e.Number||s.Number,a=e.String||s.String,c=e.Object||s.Object,u=e.Date||s.Date,l=e.SyntaxError||s.SyntaxError,f=e.TypeError||s.TypeError,p=e.Math||s.Math,h=e.JSON||s.JSON;"object"==typeof h&&h&&(t.stringify=h.stringify,t.parse=h.parse);var d,v,_,g=c.prototype,y=g.toString,m=new u(-0xc782b5b800cec);try{m=-109252==m.getUTCFullYear()&&0===m.getUTCMonth()&&1===m.getUTCDate()&&10==m.getUTCHours()&&37==m.getUTCMinutes()&&6==m.getUTCSeconds()&&708==m.getUTCMilliseconds()}catch(b){}if(!n("json")){var w="[object Function]",k="[object Date]",C="[object Number]",x="[object String]",E="[object Array]",j="[object Boolean]",T=n("bug-string-char-index");if(!m)var O=p.floor,S=[0,31,59,90,120,151,181,212,243,273,304,334],P=function(e,t){return S[t]+365*(e-1970)+O((e-1969+(t=+(t>1)))/4)-O((e-1901+t)/100)+O((e-1601+t)/400)};if((d=g.hasOwnProperty)||(d=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=y?d=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,d=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,d.call(this,e)}),v=function(e,t){var n,r,o,a=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(o in r)d.call(r,o)&&a++;return n=r=null,a?v=2==a?function(e,t){var n,r={},o=y.call(e)==w;for(n in e)o&&"prototype"==n||d.call(r,n)||!(r[n]=1)||!d.call(e,n)||t(n)}:function(e,t){var n,r,o=y.call(e)==w;for(n in e)o&&"prototype"==n||!d.call(e,n)||(r="constructor"===n)||t(n);(r||d.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],v=function(e,t){var n,o,a=y.call(e)==w,s=!a&&"function"!=typeof e.constructor&&i[typeof e.hasOwnProperty]&&e.hasOwnProperty||d;for(n in e)a&&"prototype"==n||!s.call(e,n)||t(n);for(o=r.length;n=r[--o];s.call(e,n)&&t(n));}),v(e,t)},!n("json-stringify")){var F={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",R=function(e,t){return(A+(t||0)).slice(-e)},L="\\u00",N=function(e){for(var t='"',n=0,r=e.length,o=!T||r>10,i=o&&(T?e.split(""):e);r>n;n++){var a=e.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=F[a];break;default:if(32>a){t+=L+R(2,a.toString(16));break}t+=o?i[n]:e.charAt(n)}}return t+'"'},I=function(e,t,n,r,o,i,a){var s,c,u,l,p,h,g,m,b,w,T,S,F,A,L,D;try{s=t[e]}catch(H){}if("object"==typeof s&&s)if(c=y.call(s),c!=k||d.call(s,"toJSON"))"function"==typeof s.toJSON&&(c!=C&&c!=x&&c!=E||d.call(s,"toJSON"))&&(s=s.toJSON(e));else if(s>-1/0&&1/0>s){if(P){for(p=O(s/864e5),u=O(p/365.2425)+1970-1;P(u+1,0)<=p;u++);for(l=O((p-P(u,0))/30.42);P(u,l+1)<=p;l++);p=1+p-P(u,l),h=(s%864e5+864e5)%864e5,g=O(h/36e5)%24,m=O(h/6e4)%60,b=O(h/1e3)%60,w=h%1e3}else u=s.getUTCFullYear(),l=s.getUTCMonth(),p=s.getUTCDate(),g=s.getUTCHours(),m=s.getUTCMinutes(),b=s.getUTCSeconds(),w=s.getUTCMilliseconds();s=(0>=u||u>=1e4?(0>u?"-":"+")+R(6,0>u?-u:u):R(4,u))+"-"+R(2,l+1)+"-"+R(2,p)+"T"+R(2,g)+":"+R(2,m)+":"+R(2,b)+"."+R(3,w)+"Z"}else s=null;if(n&&(s=n.call(t,e,s)),null===s)return"null";if(c=y.call(s),c==j)return""+s;if(c==C)return s>-1/0&&1/0>s?""+s:"null";if(c==x)return N(""+s);if("object"==typeof s){for(A=a.length;A--;)if(a[A]===s)throw f();if(a.push(s),T=[],L=i,i+=o,c==E){for(F=0,A=s.length;A>F;F++)S=I(F,s,n,r,o,i,a),T.push(S===_?"null":S);D=T.length?o?"[\n"+i+T.join(",\n"+i)+"\n"+L+"]":"["+T.join(",")+"]":"[]"}else v(r||s,function(e){var t=I(e,s,n,r,o,i,a);t!==_&&T.push(N(e)+":"+(o?" ":"")+t)}),D=T.length?o?"{\n"+i+T.join(",\n"+i)+"\n"+L+"}":"{"+T.join(",")+"}":"{}";return a.pop(),D}};t.stringify=function(e,t,n){var r,o,a,s;if(i[typeof t]&&t)if((s=y.call(t))==w)o=t;else if(s==E){a={};for(var c,u=0,l=t.length;l>u;c=t[u++],s=y.call(c),(s==x||s==C)&&(a[c]=1));}if(n)if((s=y.call(n))==C){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else s==x&&(r=n.length<=10?n:n.slice(0,10));return I("",(c={},c[""]=e,c),o,a,r,"",[])}}if(!n("json-parse")){var D,H,U=a.fromCharCode,q={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},M=function(){throw D=H=null,l()},B=function(){for(var e,t,n,r,o,i=H,a=i.length;a>D;)switch(o=i.charCodeAt(D)){case 9:case 10:case 13:case 32:D++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=T?i.charAt(D):i[D],D++,e;case 34:for(e="@",D++;a>D;)if(o=i.charCodeAt(D),32>o)M();else if(92==o)switch(o=i.charCodeAt(++D)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=q[o],D++;break;case 117:for(t=++D,n=D+4;n>D;D++)o=i.charCodeAt(D),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||M();e+=U("0x"+i.slice(t,D));break;default:M()}else{if(34==o)break;for(o=i.charCodeAt(D),t=D;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++D);e+=i.slice(t,D)}if(34==i.charCodeAt(D))return D++,e;M();default:if(t=D,45==o&&(r=!0,o=i.charCodeAt(++D)),o>=48&&57>=o){for(48==o&&(o=i.charCodeAt(D+1),o>=48&&57>=o)&&M(),r=!1;a>D&&(o=i.charCodeAt(D),o>=48&&57>=o);D++);if(46==i.charCodeAt(D)){for(n=++D;a>n&&(o=i.charCodeAt(n),o>=48&&57>=o);n++);n==D&&M(),D=n}if(o=i.charCodeAt(D),101==o||69==o){for(o=i.charCodeAt(++D),(43==o||45==o)&&D++,n=D;a>n&&(o=i.charCodeAt(n),o>=48&&57>=o);n++);n==D&&M(),D=n}return+i.slice(t,D)}if(r&&M(),"true"==i.slice(D,D+4))return D+=4,!0;if("false"==i.slice(D,D+5))return D+=5,!1;if("null"==i.slice(D,D+4))return D+=4,null;M()}return"$"},V=function(e){var t,n;if("$"==e&&M(),"string"==typeof e){if("@"==(T?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=B(),"]"!=e;n||(n=!0))n&&(","==e?(e=B(),"]"==e&&M()):M()),","==e&&M(),t.push(V(e));return t}if("{"==e){for(t={};e=B(),"}"!=e;n||(n=!0))n&&(","==e?(e=B(),"}"==e&&M()):M()),(","==e||"string"!=typeof e||"@"!=(T?e.charAt(0):e[0])||":"!=B())&&M(),t[e.slice(1)]=V(B());return t}M()}return e},K=function(e,t,n){var r=X(e,t,n);r===_?delete e[t]:e[t]=r},X=function(e,t,n){var r,o=e[t];if("object"==typeof o&&o)if(y.call(o)==E)for(r=o.length;r--;)K(o,r,n);else v(o,function(e){K(o,e,n)});return n.call(e,t,o)};t.parse=function(e,t){var n,r;return D=0,H=""+e,n=V(B()),"$"!=B()&&M(),D=H=null,t&&y.call(t)==w?X((r={},r[""]=n,r),"",t):n}}}return t.runInContext=r,t}var o="function"==typeof define&&define.amd,i={"function":!0,object:!0},a=i[typeof n]&&n&&!n.nodeType&&n,s=i[typeof window]&&window||this,c=a&&i[typeof t]&&t&&!t.nodeType&&"object"==typeof e&&e;if(!c||c.global!==c&&c.window!==c&&c.self!==c||(s=c),a&&!o)r(s,a);else{var u=s.JSON,l=s.JSON3,f=!1,p=r(s,s.JSON3={noConflict:function(){return f||(f=!0,s.JSON=u,s.JSON3=l,u=l=null),p}});s.JSON={parse:p.parse,stringify:p.stringify}}o&&define(function(){return p})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);